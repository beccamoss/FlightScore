{% extends 'base.html' %}
{% block content %}

<div class="row">
<div class="col-lg-8 col-lg-offset-2">
<h1>FlightScore</h1> 
<h3>Search Results</h3>
</div>
</div>

<div class="row">
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 hidden-xs">
<table class="table table-striped sortable">
<thead>
    <tr>
        <th>FlightScore</th>
        <th>Price</th>
        <th>Airline</th>
        <th class="sorttable_nosort">Flight</th>
        <th class="sorttable_nosort">From</th>
        <th class="sorttable_nosort">To</th>
        <th>Depart</th>
        <th>Arrive</th>
    </tr>
</thead>
<tbody id="flights">
   
    {% for flight in results %}
    <tr>
        <td>          
          <button data-flight-id="{{ flight['airline_code']+flight['flight_num'] }}" type="button" class="btn btn-info btn-lg flightstats">
            <meter value="{{ flight["score"] }}" min="0" max = "100" low = "30" high = "65" optimum = "85"></meter> {{ flight["score"] }}
          </button>
          
          <div id="div-{{ flight['airline_code']+flight['flight_num'] }}" style="display: none;">
            <table style="margin-left: auto; margin-right: auto; margin-top: 10px;">
              <!-- <tr style="border-bottom: 1px solid #ddd"><td># Flights: </td><td style='padding-left:8px'>{{ flight['num_flights'] }}</td></tr> -->
              <tr style="border-bottom: 1px solid #ddd"><td>% Delayed: </td><td style='padding-left:8px'>{{ flight['percent_delay'] }}%</td></tr>
              <tr style="border-bottom: 1px solid #ddd"><td>Average Delay: </td><td style='padding-left:8px'>{{ flight['avg_delay'] }} min</td></tr>
              <tr style="border-bottom: 1px solid #ddd"><td>% Cancelled: </td><td style='padding-left:8px'>{{ flight['percent_cancel_divert'] }}%</td></tr>
            </table>
          </div>
        </td>
        <td>${{ flight["price"][3:] }}</td>
        <td>{{ flight['carrier'][0] }}</td>
        <td>{{ flight['airline_code'] }} #{{ flight['flight_num'] }}</td>
        <td>{{ flight['origin_code'] }} - {{ origin }}</td>
        <td>{{ flight['destination_code'] }} - {{ destination }}</td>
        <td>{{ flight['departure_datetime'] }}</td>
        <td>{{ flight['arrival_datetime'] }}</td>
    </tr>
    {% endfor %}
</tbody>
</table>
 <script>
      $(".flightstats").click(function(evt) {
          let flightId = $(this).data("flightId");
          $('#div-'+ flightId).toggle();
        });
    </script>
</div>
</div>
{% endblock %}