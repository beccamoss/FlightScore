{% extends 'base.html' %}
{% block content %}

<div class="row">
<div class="col-lg-8 col-lg-offset-2">
<h1>FlightScore</h1> 
<h3>Search Results</h3>
</div>

<div class="row">
<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 hidden-xs">
<table class="table table-striped sortable">
<thead>
    <tr>
        <th>Score</th>
        <th>Price</th>
        <th>Airline</th>
        <th class="sorttable_nosort">Flight</th>
        <th class="sorttable_nosort">From</th>
        <th class="sorttable_nosort">To</th>
        <th>Depart</th>
        <th>Arrive</th>
    </tr>
</thead>
<tbody id="flights">
    {% for flight in results %}
    <tr>
        <td>
            <!-- Trigger the modal with a button -->
            <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">{{ flight["score"] }}</button>
            <!-- Modal -->
          <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog modal-sm">
            
              <!-- Modal content-->
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Flight Statistics</h4>
                </div>
                <div class="modal-body">
                  <p>Total Number of Flights: {{ flight['num_flights'] }}</p>
                  <p>Percentage of Flights Delayed: {{ flight['percent_delay'] }}</p>
                  <p>Average Length of Delay in Minutes: {{ flight['avg_delay'] }}</p>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
              </div>
              
            </div>
          </div>
        </td>
        <!-- <td>{{ flight["score"]}}</td> -->
        <td>${{ flight["price"][3:] }}</td>
        <td>{{ flight['carrier'][0][0] }}</td>
        <td>{{ flight['airline_code'] }} #{{ flight['flight_num'] }}</td>
        <td>{{ flight['origin_code'] }} - {{ origin }}</td>
        <td>{{ flight['destination_code'] }} - {{ destination }}</td>
        <td>{{ flight['departure_datetime'] }}</td>
        <td>{{ flight['arrival_datetime'] }}</td>
    </tr>
    {% endfor %}
</tbody>
</table>

</div>
</div>
<br>

<script type="text/javascript">
    var sortBy = document.getElementById('sort');

    // 
    sortBy.onchange = function() {
        alert(sortBy.value);

        // $('flights').load('/sort-results?order=' + sortBy.value + "&results=" + {{ results }} );
    }

</script>
{% endblock %}